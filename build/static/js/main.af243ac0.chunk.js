(this.webpackJsonpclone=this.webpackJsonpclone||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(22),i=n.n(c),s=(n(28),n(29),n(4)),o=n(17),u=n(2),l=n(8),d=n.n(l),f=n(15),h=n(12),m=n(0);function b(){var e=Object(u.f)();return Object(m.jsxs)("li",{id:"Return",onClick:function(){e.push("/battleship/")},children:[Object(m.jsx)("i",{className:"fas fa-arrow-circle-left"}),"Return to Menu"]})}function j(e){var t=e.currentPlayer,n=e.shipNum,r=e.categoryNum,c=e.coordinate,i=e.outcomesArr,s=e.setOutcomesArr;Object(a.useEffect)((function(){!function(){switch(r){case 0:i.push("".concat(t," won the battleship!"));break;case 1:i.push("".concat(t," only have ").concat(n," ").concat(1!==n?"ships":"ship"," left."));break;case 2:i.push("".concat(t," successfully hit an attack at ").concat(c,"."));break;case 3:i.push("".concat(t," missed an attack at ").concat(c,"."));break;default:i.push("The game has started...")}if(i<5){var e=i.slice(1);s(e)}console.log("well?")}()}),[n,t]);return Object(m.jsx)("div",{children:void i.map((function(e){return Object(m.jsx)("p",{children:e})}))})}var p=n(9),v=function(e,t){var n="safe",a=t,r=function(){return 0===a?n="sunk":null};return{getName:function(){return e},getHealth:function(){return a},getCurrentState:function(){return n},hit:function(){a-=1,n="hit",r()},isSunk:r}};function g(){var e=[["Carrier",5],["Battleship",4],["Cruiser",3],["Submariner",3],["Destroyer",2]],t={x:-15,y:-15},n=function(e,t){for(var n=[],a=0;a<e;a++){for(var r=[],c=0;c<t;c++){var i=[];i.push("".concat(String.fromCharCode(65+a)).concat(c+1),0),r.push(i)}n.push(r)}return n}(10,10),a=function(e){var t=10-e;return Math.floor(Math.random()*t)+1},r=[];function c(e,t){this.x=e,this.y=t}var i=[],s=function e(t,n){for(var r=[],i=a(t),s=Math.floor(Math.random()*n),o=Math.round(Math.random()),l=function(e){return e>.5?0:1}(o),d=0;d<t;d++){var f=[i+d,s];r.push(new c(f[o],f[l]))}return!0===u(i,s,t,o)?e(t,n):r},o=function(){for(var t=[],n=0;n<e.length;n++){var a=e[n][0],c=e[n][1],i=s(c,10);r.push.apply(r,Object(p.a)(i));var o=v(a,c);t.push({ship:o,pos:i})}return t},u=function(e,t,n,a){return 0!==r.length&&r.some((function(r){return 0===a?r.x>=e&&r.x<=e+n&&r.y===t:r.y>=e&&r.y<=e+n&&r.x===t}))},l=o(),d=l.length,h=function(e){"sunk"===e.ship.getCurrentState()&&(d-=1)},m=function(e,t,n){var a,c=Object(f.a)(n);try{for(c.s();!(a=c.n()).done;){var i,s=a.value,o=Object(f.a)(s.pos);try{for(o.s();!(i=o.n()).done;){var u=i.value;if(u.x===e&&u.y===t)return s.ship.hit(),h(s),b(r,e,t),!1}}catch(l){o.e(l)}finally{o.f()}}}catch(l){c.e(l)}finally{c.f()}return!0},b=function(e,n,a){e.forEach((function(r,c){if(r.x===n&&r.y===a){var i,s=e.splice(c,1);return console.log(s),t=s[0],(i=[]).concat.apply(i,Object(p.a)(s))}}))};return{height:10,width:10,randomNumGen:a,shipsOnTheBoard:l,addShipsToTheBoard:o,board:n,resetArray:function(e){for(;e.length>0;)e.pop()},resetBoard:function(){n.map((function(e){e.map((function(e){e[1]=0}))}))},missedAtks:i,recentAtk:null,currentTotalShips:d,validateCoordinates:u,receiveAttack:function(e,t,a){e>10&&t>10||(n[e][t][1]||(n[e][t][1]=1-n[e][t][1],!0===m(e,t,a)&&i.push({x:e,y:t})))},isShipGotHit:m,occupiedPos:r,getRecentCoordinate:function(){return t},getOccupiedPos:function(){return r},getCurrentTotalShips:function(){return d}}}function O(e,t,n,a){var r=e,c=t,i=a,s=c?"Player":"AI",o=n,u=g(),l=function(e){for(var t=[],n=0;n<e;n++)for(var a=0;a<e;a++)t.push([n,a]);return t},d=l(10);return{gameboard:u,turn:r,togglePlayerTurn:function(e){return!e},aiMove:function(r){var c,i=u.getOccupiedPos().length,s=u.getCurrentTotalShips();if(console.log(e,t,n,a),1==o&&0!==r.length){var l,d=r.splice((c=r.length-1,Math.floor(Math.random()*c)),1);return(l=[]).concat.apply(l,Object(p.a)(d))}if(2==o&&0!==r.length){var f=[0,-1],h=[0,1],m=[1,0],b=[-1,0],j=[f,h,m,b];return 0===j.length&&(j=j=[f,h,m,b]),function(e,t,n,a,r){var c,i=4!==r.length?e.recentAtk:a.splice(Math.floor(Math.random()*a.length)-1,1),s=e.getOccupiedPos().length,o=e.getCurrentTotalShips(),u=0;console.log(i);var l=Math.floor(Math.random()*r.length-1)+1,d=r.splice(l,1);if(t!==s&&n===o||4!==r.length){var f,h;return console.log("yes"),1===(u+=1)&&(e.recentAtk=(h=[]).concat.apply(h,Object(p.a)(i))),console.log(i),i[0]+=d[0],i[1]+=d[1],console.log(i),(f=[]).concat.apply(f,Object(p.a)(i))}return(c=[]).concat.apply(c,Object(p.a)(i))}(u,i,s,r,j)}},aiLegalAtks:d,selectedAtk:function(e,t){return[e,t]},isWinner:!1,isHuman:c,displayName:s,toggleLegality:function(e,t){var n=d.findIndex((function(n){return n[0]===e&n[1]===t}));d.splice(n,1)},refillLegalAtks:function(){return l(10)},playerNum:i}}var y=O(!0,!0,1,1),x=O(!1,!1,1,2);function N(){return(N=Object(h.a)(d.a.mark((function e(t,n,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0==t?(y=O(!0,!0,null,1),x=O(!1,!0,null,2)):1==t?(y=O(!0,!0,null,1),x=O(!1,!1,a,2)):(y=O(!0,!1,n,1),x=O(!1,!1,a,2)),S(y,x);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=function(e,t){e.turn=e.togglePlayerTurn(e.turn),t.turn=t.togglePlayerTurn(t.turn)},S=function(e,t){!0===e.isHuman&&!0===t.isHuman?(e.displayName="Player 1",t.displayName="Player 2"):!1===e.isHuman&&!1===t.isHuman?(e.displayName="AI 1",t.displayName="AI 2"):(e.displayName="Player",t.displayName="AI")},A=function(e,t){0==e.gameboard.getOccupiedPos().length?t.isWinner=!0:0==t.gameboard.getOccupiedPos().length&&(e.isWinner=!0)},C=function(e,t){if(e.turn){var n=e.aiMove(e.aiLegalAtks),a=t.gameboard.shipsOnTheBoard;t.gameboard.receiveAttack(n[0],n[1],a)}else if(t.turn){var r=t.aiMove(t.aiLegalAtks),c=e.gameboard.shipsOnTheBoard;e.gameboard.receiveAttack(r[0],r[1],c)}A(e,t),k(e,t)},w=function(e){var t=e.gameboard;t.resetArray(t.occupiedPos),t.shipsOnTheBoard=t.addShipsToTheBoard()},T=function(e){w(e),e.isWinner&&(e.isWinner=!1),e.gameboard.resetBoard(),e.aiLegalAtks=e.refillLegalAtks()};function P(e){var t=e.gamemode,n=(e.difficulty,window.innerWidth),r=(window.innerHeight,Object(a.useState)(y)),c=Object(s.a)(r,1)[0],i=Object(a.useState)(x),o=Object(s.a)(i,1)[0],u=Object(a.useState)([]),l=Object(s.a)(u,2),p=l[0],v=l[1],g=Object(a.useState)(null),O=Object(s.a)(g,2),N=O[0],S=O[1],P=Object(a.useState)(!1),H=Object(s.a)(P,2),B=H[0],M=H[1],I=Object(a.useState)(!0),E=Object(s.a)(I,2),R=E[0],L=E[1],W=Object(a.useState)({turn:1,isHuman:y.turn}),D=Object(s.a)(W,2),G=D[0],z=D[1],J=Object(a.useState)(0),V=Object(s.a)(J,2),q=V[0],X=V[1],Y=n<600?.6*n:.2*n,F=Object(a.useRef)(null),K=Object(a.useRef)(null),Q=Object(a.useState)(!0),U=Object(s.a)(Q,2),Z=U[0],$=U[1],_=Object(a.useState)(!0),ee=Object(s.a)(_,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),re=Object(s.a)(ae,2),ce=re[0],ie=re[1],se=Object(a.useState)(null),oe=Object(s.a)(se,2),ue=oe[0],le=oe[1],de=Object(a.useState)(null),fe=Object(s.a)(de,2),he=fe[0],me=fe[1],be=function(){B||0!==t.value||($(!1),ne(!1)),B||(M(!B),ve())},je=function(){L(!R)};function pe(){return new Promise((function(e){setTimeout((function(){T(c),T(o),e("resolved")}),200)}))}var ve=function(){M(!B),S(!1),z({turn:1,isHuman:c.isHuman}),v([]),ie(null)};function ge(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(h.a)(d.a.mark((function e(){var t,n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=F.current,n=K.current,a=t.getContext("2d"),r=n.getContext("2d"),!B){e.next=10;break}return e.next=7,pe();case 7:Se(a,Y,c),Se(r,Y,o),ve();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye=function(e){var t=F.current,n=K.current,a=t.getContext("2d"),r=n.getContext("2d");"randomize-p1"===e.target.id?(w(c),Se(a,Y,c)):(w(o),Se(r,Y,o))},xe=function(e){e.target.id.includes("p1")?$(!Z):ne(!te)},Ne=function(e,t,n,a){n.fillStyle="rgb(7,67,114)",n.fillRect(e*a,t*a,a,a),n.strokeStyle="rgba(7,100,176,0.3)",n.strokeRect(e*a,t*a,a,a),n.lineWidth=1},ke=function(e,t,n,a,r,c){n.fillStyle="rgb(224,224,224)",n.strokeStyle="rgb(34,34,34)";for(var i=0;i<r;i++)0===c?n.fillRect(e*a,t*a,a,a*r):n.fillRect(e*a,t*a,a*r,a);0===c?n.strokeRect(e*a,t*a,a,a*r):n.strokeRect(e*a,t*a,a*r,a)},Se=function(e,t,n){var a=.1*t,r=n.gameboard.shipsOnTheBoard,c=n.gameboard.getOccupiedPos(),i=n.gameboard.board;e.clearRect(0,0,a,a),i.forEach((function(t,i){t.forEach((function(t,s){(Z||!0!==n.turn)&&(te||!1!==n.turn)&&n.isHuman&&1==c.filter((function(e){return e.x===i&&e.y===s})).length?Ae(r,s,i,e,a):Ne(s,i,e,a)}))}))},Ae=function(e,t,n,a,r){var c,i=Object(f.a)(e);try{for(i.s();!(c=i.n()).done;){var s=c.value;s.pos[0].x===n&&s.pos[0].y===t&&(s.pos[0].x===n&&s.pos[1].x===n?ke(t,n,a,r,s.pos.length,1):ke(t,n,a,r,s.pos.length,0))}}catch(o){i.e(o)}finally{i.f()}},Ce=function(e,t,n){var a=.1*t,r=n.gameboard.board,c=n.gameboard.getRecentCoordinate();r.forEach((function(t,r){t.forEach((function(t,i){1===t[1]&&(le(t[0]),c.x===r&&c.y===i?(Te(i+1,r+1,e,a,!0),Pe(i+1,r+1,e,a,!0),ie(2),me(n.gameboard.getCurrentTotalShips()),we(he,n)):(ie(3),Te(i+1,r+1,e,a,!1),Pe(i+1,r+1,e,a,!1)),t[1]=2)}))}))},we=function(e,t){e===t.gameboard.getCurrentTotalShips()&&ie(1)},Te=function(e,t,n,a,r){n.beginPath(),n.lineWidth=2,n.moveTo(e*a-a*(3/4),t*a-a*(3/4)),n.lineTo(e*a-a/4,t*a-a/4),n.moveTo(e*a-a/4,t*a-a*(3/4)),n.lineTo(e*a-a*(3/4),t*a-a/4),n.strokeStyle=He(r),n.stroke()},Pe=function(e,t,n,a,r){var c=e*a-a+a/2,i=t*a-a+a/2,s=Math.PI+Math.PI*e/2;n.beginPath(),n.lineWidth=2,n.arc(c,i,a/3,0,s),n.strokeStyle=He(r),n.stroke()},He=function(e){return e?"red":"rgb(77,166,215)"},Be=function(e,t,n,a){return Object(m.jsx)("div",{className:"base-container",children:Object(m.jsxs)("div",{className:"canvas-container",children:[Me(a),Object(m.jsx)("canvas",{ref:e,className:"cv",id:n,width:"".concat(t,"px"),height:"".concat(t,"px")}),!B&&a.isHuman?Ee(n):null]})})},Me=function(e){return Object(m.jsx)("div",{className:"player-resource-container",children:Object(m.jsx)("p",{children:e.displayName})})},Ie=function(){return N?Object(m.jsx)("p",{className:n>500?"display-victory":"mobile-display-victory",children:c.isWinner?"".concat(c.displayName," wins!!"):"".concat(o.displayName," wins!!")}):Object(m.jsx)("p",{className:n>500?"display-turn":"mobile-display-turn",children:c.turn?"".concat(c.displayName," turn"):"".concat(o.displayName," turn")})},Ee=function(e){return Object(m.jsx)("div",{className:"button-container",children:Object(m.jsxs)("div",{id:"p1-bottom-side",children:[Object(m.jsx)("button",{className:"in-game-btn",id:"cv1"===e?"randomize-p1":"randomize-p2",onClick:ye,children:"Randomize"}),Object(m.jsx)("button",{className:"in-game-btn",id:"cv1"===e?"tglVsb-p1":"tglVsb-p2",onClick:xe,children:"Toggle visibility"})]})})};return Object(a.useEffect)((function(){var e=F.current,t=K.current,n=e.getContext("2d"),a=t.getContext("2d");Se(n,Y,c),Se(a,Y,o)}),[Z,te]),Object(a.useEffect)((function(){var e=F.current,t=K.current,n=e.getContext("2d"),a=t.getContext("2d"),r=.1*Y;ie(null);var i=function(e,t,n,a){var c=n.getBoundingClientRect(),i=a.clientX-c.left,s=a.clientY-c.top;return function(e,t,n,a){if(!e.aiLegalAtks.some((function(e){return e[0]===n&&e[1]===a})))return!0;var r=t.gameboard.shipsOnTheBoard;return e.toggleLegality(n,a),t.gameboard.receiveAttack(a,n,r),A(y,x),k(y,x),!1}(e,t,Math.round((i-r/2)/r),Math.round((s-r/2)/r))},s=function(e,t,n,a){e.turn&&B&&n.addEventListener("mousedown",(function r(c){if(i(e,t,n,c))return X(q+1),n.removeEventListener("mousedown",r);Ce(a,Y,t),z({turn:t.playerNum,isHuman:t.isHuman}),n.removeEventListener("mousedown",r)}))},u=function(){s(c,o,t,a),s(o,c,e,n)},l=function(){if(c.turn)return C(c,o),Ce(a,Y,o),void z({turn:o.playerNum,isHuman:o.isHuman});o.turn&&(C(c,o),Ce(n,Y,c),z({turn:c.playerNum,isHuman:c.isHuman}))};function f(e){return m.apply(this,arguments)}function m(){return(m=Object(h.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){l()}),t),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.isWinner&&!o.isWinner){e.next=4;break}return S(!0),ie(0),e.abrupt("return");case 4:if(G.isHuman){e.next=8;break}return e.next=7,f(150);case 7:return e.abrupt("return");case 8:return u(),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return B&&!N&&function(){b.apply(this,arguments)}(),console.log(G),console.log("Is current player human: "+G.isHuman),function(){clearTimeout(f)}}),[G,B,q]),Object(m.jsxs)("div",{id:"Battle",children:[Object(m.jsxs)("div",{id:"upper-container",children:[Object(m.jsx)(b,{}),Object(m.jsx)("div",{id:"instructions-wrapper",children:N?Object(m.jsx)("span",{children:"Game ended"}):(c.isHuman||o.isHuman)&&B?Object(m.jsx)("span",{children:"Destroy the enemy's ships"}):!c.isHuman&&!o.isHuman||B?2!=t.value||B?Object(m.jsx)("span",{children:"Get some popcorn"}):Object(m.jsx)("span",{children:"Start the battle"}):Object(m.jsx)("span",{children:"Place the ships"})}),Object(m.jsxs)("div",{id:"upper-button-container",children:[Object(m.jsx)("button",{onClick:B?ge:be,children:B?Object(m.jsx)("i",{className:"fas fa-redo-alt"}):Object(m.jsx)("i",{className:"fas fa-play"})}),Object(m.jsx)("button",{id:"outcome-visibility-button",onClick:je,children:R?Object(m.jsx)("i",{className:"fas fa-eye"}):Object(m.jsx)("i",{class:"fas fa-eye-slash"})})]})]}),(null!==c||null!==o)&&n<=500?Ie():null,Object(m.jsxs)("div",{id:"main-battle",children:[Be(F,Y,"cv1",c),(null!==c||null!==o)&&n>500?Ie():null,Be(K,Y,"cv2",o)]}),Object(m.jsx)("div",{id:"Outcomes",children:null!==ce&&R?0===ce?Object(m.jsx)("div",{className:"outcomes-victory",children:Object(m.jsx)(j,{currentPlayer:1===G.turn?c.displayName:o.displayName,shipNum:1===G.turn?c.gameboard.getCurrentTotalShips():o.gameboard.getCurrentTotalShips(),categoryNum:ce,coordinate:null,outcomesArr:p,setOutcomesArr:v})}):1===ce?Object(m.jsx)("div",{className:"outcomes-information",children:Object(m.jsx)(j,{currentPlayer:1===G.turn?c.displayName:o.displayName,shipNum:1===G.turn?c.gameboard.getCurrentTotalShips():o.gameboard.getCurrentTotalShips(),categoryNum:ce,coordinate:null,outcomesArr:p,setOutcomesArr:v})}):(2===ce||console.log(p),Object(m.jsx)("div",{className:"outcomes-action",children:Object(m.jsx)(j,{currentPlayer:1===G.turn?c.displayName:o.displayName,shipNum:(G.turn,he),categoryNum:ce,coordinate:ue,outcomesArr:p,setOutcomesArr:v})})):null})]})}var H=n(16);function B(e){var t=e.setGamemode,n=e.gamemode,a=e.difficulty,r=e.setDifficulty,c=function(e){e.target.id.includes(2)||1==n.value?r(Object(H.a)(Object(H.a)({},a),{},{value:e.target.value,valB:e.target.value})):r(Object(H.a)(Object(H.a)({},a),{},{value:e.target.value,valA:e.target.value}))};return Object(m.jsxs)("div",{id:"Settings",children:[Object(m.jsx)("div",{className:"custom-select",children:Object(m.jsxs)("select",{name:"gamemodes",value:n.value,onChange:function(e){t({value:e.target.value})},children:[Object(m.jsx)("option",{value:"0",children:"PvP"}),Object(m.jsx)("option",{value:"1",children:"PvAI"}),Object(m.jsx)("option",{value:"2",children:"AIvAI"})]})}),2==n.value?Object(m.jsx)(M,{gamemode:n,difficulty:a,id:1,handleDifficultyChange:c}):null,0!=n.value?Object(m.jsx)(M,{gamemode:n,difficulty:a,id:2,handleDifficultyChange:c}):null]})}var M=function(e){var t=e.gamemode,n=e.difficulty,a=e.id,r=e.handleDifficultyChange;return Object(m.jsx)("div",{className:"custom-select",id:"ai-diff".concat(a),children:Object(m.jsxs)("select",{name:"diff",value:n.value,onChange:r,children:[Object(m.jsx)("option",{value:"1",children:1==t.value||1==a?"AI: Easy":"AI 2: Easy"}),Object(m.jsx)("option",{value:"2",children:1==t.value||1==a?"AI: Hard":"AI 2: Hard"})]})})};function I(){var e=Object(a.useState)({value:"0"}),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)({value:"1",valA:"1",valB:"1"}),i=Object(s.a)(c,2),u=i[0],l=i[1];return Object(m.jsx)(o.a,{children:Object(m.jsx)(E,{gamemode:n,setGamemode:r,difficulty:u,setDifficulty:l})})}function E(e){var t=e.gamemode,n=e.setGamemode,a=e.difficulty,r=e.setDifficulty;return Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{exact:!0,path:"/battleship/",children:Object(m.jsx)(R,{setGamemode:n,gamemode:t,difficulty:a,setDifficulty:r})}),Object(m.jsx)(u.a,{exact:!0,path:"/battleship/battle",children:Object(m.jsx)(P,{gamemode:t,difficulty:a})})]})}function R(e){var t=e.setGamemode,n=e.gamemode,r=e.difficulty,c=e.setDifficulty;return Object(a.useEffect)((function(){document.getElementById("prf").onclick=function(){window.location.href="https://github.com/law911012eqw"}})),Object(a.useEffect)((function(){!function(e,t){!function(e,t,n){N.apply(this,arguments)}(parseInt(e.value),parseInt(t.valA),parseInt(t.valB))}(n,r)}),[n,r]),Object(m.jsxs)("div",{id:"menu",children:[Object(m.jsxs)("div",{className:"title-wrapper",children:[Object(m.jsx)("h1",{id:"title",className:"title",children:"Battleship"}),Object(m.jsxs)("div",{className:"author-wrapper",children:[Object(m.jsx)("h2",{className:"divider",children:" | "}),Object(m.jsx)("h5",{className:"author",children:"Created by B.B Ant"}),Object(m.jsx)("div",{className:"frame",children:Object(m.jsx)("img",{id:"prf",className:"prof",src:"https://avatars.githubusercontent.com/u/73290979?s=400&u=2df2e8360dbecaf0265e22194b52647c95ea6e06&v=4",alt:"profile"})})]})]}),Object(m.jsx)("nav",{id:"nav-menu",children:Object(m.jsx)("ul",{children:Object(m.jsx)("div",{children:Object(m.jsx)("li",{children:Object(m.jsx)(o.b,{to:"/battleship/battle",children:"Start Game"})})})})}),Object(m.jsx)(B,{setGamemode:t,gamemode:n,difficulty:r,setDifficulty:c})]})}var L=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(I,{})})};i.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(L,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.af243ac0.chunk.js.map