(this.webpackJsonpclone=this.webpackJsonpclone||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(22),i=n.n(c),o=(n(28),n(29),n(4)),s=n(17),u=n(2),l=n(9),d=n.n(l),f=n(15),h=n(12),m=n(0);function p(){var e=Object(u.f)();return Object(m.jsxs)("li",{id:"Return",onClick:function(){e.push("/battleship/")},children:[Object(m.jsx)("i",{className:"fas fa-arrow-circle-left"}),"Return to Menu"]})}function b(e){var t=e.p,n=e.currentPlayer,r=e.categoryNum,c=e.coordinate,i=e.outcomesArr,o=e.setOutcomesArr;Object(a.useEffect)((function(){if(i.length>5){var e=i.slice(1);o(e)}!function(){if(null!==r)switch(r){case 0:i.push("".concat(n," won the battleship!"));break;case 2:i.push("".concat(n," successfully hit an attack at ").concat(c,"."));break;case 3:i.push("".concat(n," missed an attack at ").concat(c,"."))}}(),console.log(i)}),[t,n,i,c]);var s=i.map((function(e,t){return Object(m.jsx)("li",{children:e},t)}));return Object(m.jsx)("ul",{id:"Outcomes",children:s})}var j=n(8),v=function(e,t){var n="safe",a=t,r=function(){return 0===a?n="sunk":null};return{getName:function(){return e},getHealth:function(){return a},getCurrentState:function(){return n},hit:function(){a-=1,n="hit",r()},isSunk:r}};function g(){var e=[["Carrier",5],["Battleship",4],["Cruiser",3],["Submariner",3],["Destroyer",2]],t={x:-15,y:-15},n=function(e,t){for(var n=[],a=0;a<e;a++){for(var r=[],c=0;c<t;c++){var i=[];i.push("".concat(String.fromCharCode(65+a)).concat(c+1),0),r.push(i)}n.push(r)}return n}(10,10),a=[];function r(e,t){this.x=e,this.y=t}var c=[],i=function e(t,n){for(var a=[],c=function(e){var t=10-e;return Math.floor(Math.random()*t)+1}(t),i=Math.floor(Math.random()*n),o=Math.round(Math.random()),u=function(e){return e>.5?0:1}(o),l=0;l<t;l++){var d=[c+l,i];a.push(new r(d[o],d[u]))}return!0===s(c,i,t,o)?e(t,n):a},o=function(){for(var t=[],n=0;n<e.length;n++){var r=e[n][0],c=e[n][1],o=i(c,10);a.push.apply(a,Object(j.a)(o));var s=v(r,c);t.push({ship:s,pos:o})}return t},s=function(e,t,n,r){return 0!==a.length&&a.some((function(a){return 0===r?a.x>=e&&a.x<=e+n&&a.y===t:a.y>=e&&a.y<=e+n&&a.x===t}))},u=o(),l=u.length,d=function(e){"sunk"===e.ship.getCurrentState()&&(l-=1)},h=function(e,t,n){var r,c=Object(f.a)(n);try{for(c.s();!(r=c.n()).done;){var i,o=r.value,s=Object(f.a)(o.pos);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u.x===e&&u.y===t)return o.ship.hit(),d(o),m(a,e,t),!1}}catch(l){s.e(l)}finally{s.f()}}}catch(l){c.e(l)}finally{c.f()}return!0},m=function(e,n,a){e.forEach((function(r,c){if(r.x===n&&r.y===a){var i,o=e.splice(c,1);return t=o[0],(i=[]).concat.apply(i,Object(j.a)(o))}}))};return{shipsOnTheBoard:u,addShipsToTheBoard:o,board:n,resetArray:function(e){for(;e.length>0;)e.pop()},resetBoard:function(){n.map((function(e){e.map((function(e){e[1]=0}))}))},currentTotalShips:l,missedAtks:c,receiveAttack:function(e,t,a){e>10&&t>10||(n[e][t][1]||(n[e][t][1]=1-n[e][t][1],!0===h(e,t,a)&&c.push({x:e,y:t})))},occupiedPos:a,getRecentCoordinate:function(){return t},getOccupiedPos:function(){return a},getCurrentTotalShips:function(){return l}}}function O(e,t,n,a){var r=e,c=t,i=a,o=c?"Player":"AI",s=n,u=g(),l=17,d=function(e){for(var t=[],n=0;n<e;n++)for(var a=0;a<e;a++)t.push([n,a]);return t},f=d(10),h=null;function m(e){h=e}return{gameboard:u,turn:r,togglePlayerTurn:function(e){return!e},aiMove:function(e){if(0!==e.length){var t;if(2==s)return function(e,t,n,a,r,c){var i,o;console.log(t),console.log(r),console.log(a);var s=Math.floor(Math.random()*e.length-1),u=function(e){return e[Math.floor(2*Math.random())]},l=function(e,n,a){var r=t;return console.log(e,a),-1===n.findIndex((function(t){return"y"===a?t[0][1]===r[1]+e&&t[0][0]===r[0]:t[0][0]===r[0]+e&&t[0][1]===r[1]}))&&d(n),console.log("only once"),n.splice(s,1)},d=function(e){console.log(e);var t=u([1,-1]),n=u(["x","y"]);l(t,e,n)};if(null!==t){var f=d(e);o=e.splice(f,1)}else o=e.splice(s,1);return r.some((function(e){return e.x===o[0][0]&&e.y===o[0][1]}))&&n(o),c&&(n(null),c=!c),console.log(o),(i=[]).concat.apply(i,Object(j.a)(o))}(e,h,m,undefined,l,false);var n=e.splice((a=e.length-1,Math.floor(Math.random()*a)),1);return(t=[]).concat.apply(t,Object(j.a)(n))}var a},aiLegalAtks:f,recentSunk:false,opponentOccupiedPosLeft:l,selectedAtk:function(e,t){return[e,t]},isWinner:!1,isHuman:c,displayName:o,toggleLegality:function(e,t){var n=f.findIndex((function(n){return n[0]===e&n[1]===t}));f.splice(n,1)},refillLegalAtks:function(){return d(10)},playerNum:i,getAiLegalAtks:function(){return f},setAiLegalAtks:function(e){f=e},setOpponentOccupiedPosLeft:function(e){l=e}}}var y=O(!0,!0,1,1),x=O(!1,!1,1,2);function k(){return(k=Object(h.a)(d.a.mark((function e(t,n,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0==t?(y=O(!0,!0,null,1),x=O(!1,!0,null,2),y.displayName="Player 1",x.displayName="Player 2"):1==t?(y=O(!0,!0,null,1),x=O(!1,!1,a,2),y.displayName="Player",x.displayName="AI"):(y=O(!0,!1,n,1),x=O(!1,!1,a,2),y.displayName="AI 1",x.displayName="AI 2");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=function(e,t){e.turn=e.togglePlayerTurn(e.turn),t.turn=t.togglePlayerTurn(t.turn)},A=function(e,t){0==e.gameboard.getOccupiedPos().length?t.isWinner=!0:0==t.gameboard.getOccupiedPos().length&&(e.isWinner=!0)},w=function(e,t){S(e,t),S(t,e),A(e,t),N(e,t)},S=function(e,t){if(e.turn){e.setOpponentOccupiedPosLeft(t.gameboard.getOccupiedPos());var n=t.gameboard.getCurrentTotalShips(),a=e.aiMove(e.aiLegalAtks),r=t.gameboard.shipsOnTheBoard;t.gameboard.receiveAttack(a[0],a[1],r),n!==t.gameboard.getCurrentTotalShips()&&(e.recentSunk=!0)}},C=function(e){var t=e.gameboard;t.resetArray(t.occupiedPos),t.shipsOnTheBoard=t.addShipsToTheBoard()},P=function(e){C(e),e.isWinner&&(e.isWinner=!1),e.gameboard.resetBoard();var t=e.refillLegalAtks();e.isHuman?e.setAiLegalAtks(t):e.aiLegalAtks=t};function T(){var e={},t=1;this.add=function(n){for(var a,r=arguments.length,c=new Array(r>1?r-1:0),i=1;i<r;i++)c[i-1]=arguments[i];(a=n.addEventListener||n.add||n.addListener).call.apply(a,[n].concat(c));var o=t++;if(e[o]={elem:n,args:c},c.length<2)throw new Error("too few args");return o},this.remove=function(t){var n=e[t];if(n){var a;delete n[t];var r=n.elem;(a=r.removeEventListener||r.removeListener).call.apply(a,[r].concat(Object(j.a)(n.args)))}},this.removeAll=function(){var t=e;e={},Object.keys(t).forEach((function(e){var n,a=t[e];if(a.args<2)throw new Error("too few args");var r=a.elem;(n=r.removeEventListener||r.removeListener).call.apply(n,[r].concat(Object(j.a)(a.args)))}))}}function E(e){var t=e.gamemode,n=(e.difficulty,window.innerWidth),r=n<600?.6*n:.2*n,c=Object(a.useState)(y),i=Object(o.a)(c,1)[0],s=Object(a.useState)(x),u=Object(o.a)(s,1)[0],l=Object(a.useState)([]),j=Object(o.a)(l,2),v=j[0],g=j[1],O=Object(a.useState)(!1),k=Object(o.a)(O,2),S=k[0],E=k[1],L=Object(a.useState)(!1),B=Object(o.a)(L,2),H=B[0],I=B[1],M=Object(a.useState)(!1),R=Object(o.a)(M,2),D=R[0],W=R[1],G=Object(a.useState)({turn:1,isHuman:y.turn}),z=Object(o.a)(G,2),J=z[0],V=z[1],q=Object(a.useState)(0),X=Object(o.a)(q,2),Y=X[0],F=X[1],K=new T,Q=Object(a.useRef)(null),U=Object(a.useRef)(null),Z=Object(a.useState)(!0),$=Object(o.a)(Z,2),_=$[0],ee=$[1],te=Object(a.useState)(!0),ne=Object(o.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)(null),ie=Object(o.a)(ce,2),oe=ie[0],se=ie[1],ue=Object(a.useState)(null),le=Object(o.a)(ue,2),de=le[0],fe=le[1],he=function(){H||0!=t.value||(ee(!1),re(!1)),I(!H),g(["The game has started..."])},me=function(){W(!D),se(!1)};function pe(){return new Promise((function(e){setTimeout((function(){P(i),P(u),e("resolved")}),200)}))}var be=function(){I(!H),E(!1),se(null),V({turn:1,isHuman:i.isHuman}),K.removeAll()};function je(){return ve.apply(this,arguments)}function ve(){return(ve=Object(h.a)(d.a.mark((function e(){var t,n,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Q.current,n=U.current,a=t.getContext("2d"),c=n.getContext("2d"),a.clearRect(0,0,t.width,t.height),c.clearRect(0,0,n.width,n.height),!H){e.next=13;break}return i.turn||N(i,u),e.next=10,pe();case 10:ke(a,r,i),ke(c,r,u),be();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge=function(e){var t=Q.current,n=U.current,a=t.getContext("2d"),c=n.getContext("2d");if("randomize-p1"===e.target.id)return C(i),void ke(a,r,i);C(u),ke(c,r,u)},Oe=function(e){e.target.id.includes("1")?ee(!_):re(!ae)},ye=function(e,t,n,a){n.fillStyle="rgb(7,67,114)",n.fillRect(e*a,t*a,a,a),n.strokeStyle="rgb(7,100,176)",n.strokeRect(e*a,t*a,a,a)},xe=function(e,t,n,a,r,c){n.fillStyle="rgb(224,224,224)",n.strokeStyle="rgb(34,34,34)";for(var i=0;i<r;i++)0===c?n.fillRect(e*a,t*a,a,a*r):n.fillRect(e*a,t*a,a*r,a);0===c?n.strokeRect(e*a,t*a,a,a*r):n.strokeRect(e*a,t*a,a*r,a)},ke=function(e,t,n){var a=.1*t,r=n.gameboard.shipsOnTheBoard,c=n.gameboard.getOccupiedPos();n.gameboard.board.forEach((function(t,i){t.forEach((function(t,o){(_||!0!==n.turn)&&(ae||!1!==n.turn)&&n.isHuman&&1==c.filter((function(e){return e.x===i&&e.y===o})).length?Ne(r,o,i,e,a):ye(o,i,e,a)}))}))},Ne=function(e,t,n,a,r){var c,i=Object(f.a)(e);try{for(i.s();!(c=i.n()).done;){var o=c.value;o.pos[0].x===n&&o.pos[0].y===t&&(o.pos[0].x===n&&o.pos[1].x===n?xe(t,n,a,r,o.pos.length,1):xe(t,n,a,r,o.pos.length,0))}}catch(s){i.e(s)}finally{i.f()}},Ae=function(e,t,n){var a=.1*t,r=n.gameboard.board,c=n.gameboard.getRecentCoordinate();r.forEach((function(t,n){t.forEach((function(t,r){1===t[1]&&(fe(t[0]),c.x===n&&c.y===r?(se(2),we(r+1,n+1,e,a,!0),Se(r+1,n+1,e,a,!0)):(se(3),we(r+1,n+1,e,a,!1),Se(r+1,n+1,e,a,!1)),t[1]=2)}))}))},we=function(e,t,n,a,r){n.beginPath(),n.lineWidth=2,n.moveTo(e*a-a*(3/4),t*a-a*(3/4)),n.lineTo(e*a-a/4,t*a-a/4),n.moveTo(e*a-a/4,t*a-a*(3/4)),n.lineTo(e*a-a*(3/4),t*a-a/4),n.strokeStyle=Ce(r),n.stroke()},Se=function(e,t,n,a,r){var c=e*a-a+a/2,i=t*a-a+a/2,o=Math.PI+Math.PI*e/2;n.beginPath(),n.lineWidth=2,n.arc(c,i,a/3,0,o),n.strokeStyle=Ce(r),n.stroke()},Ce=function(e){return e?"red":"rgb(77,166,215)"},Pe=function(e,t,n,a){return Object(m.jsx)("div",{className:"base-container",children:Object(m.jsxs)("div",{className:"canvas-container",children:[Te(a),Object(m.jsx)("canvas",{ref:e,className:"cv",id:n,width:"".concat(t,"px"),height:"".concat(t,"px")}),!H&&a.isHuman?Le(n):null]})})},Te=function(e){return Object(m.jsx)("div",{className:"player-resource-container",children:Object(m.jsx)("p",{children:e.displayName})})},Ee=function(){return S?Object(m.jsx)("p",{className:n>500?"display-victory":"mobile-display-victory",children:i.isWinner?"".concat(i.displayName," wins!!"):"".concat(u.displayName," wins!!")}):Object(m.jsx)("p",{className:n>500?"display-turn":"mobile-display-turn",children:i.turn?"".concat(i.displayName," turn"):"".concat(u.displayName," turn")})},Le=function(e){return Object(m.jsx)("div",{className:"button-container",children:Object(m.jsxs)("div",{id:"p1-bottom-side",children:[Object(m.jsx)("button",{className:"in-game-btn",id:"cv1"===e?"randomize-p1":"randomize-p2",onClick:ge,children:"Randomize"}),Object(m.jsx)("button",{className:"in-game-btn",id:"cv1"===e?"tglVsb-p1":"tglVsb-p2",onClick:Oe,children:"Toggle visibility"})]})})};return Object(a.useEffect)((function(){var e=Q.current,t=U.current,n=e.getContext("2d"),a=t.getContext("2d");ke(n,r,i),ke(a,r,u)}),[_,ae]),Object(a.useEffect)((function(){var e=Q.current,t=U.current,n=e.getContext("2d"),a=t.getContext("2d"),c=.1*r,o=function(e,t,n,a){var r=n.getBoundingClientRect(),i=a.clientX-r.left,o=a.clientY-r.top;return function(e,t,n,a){if(!e.getAiLegalAtks().some((function(e){return e[0]===n&&e[1]===a})))return!0;var r=t.gameboard.shipsOnTheBoard;return e.toggleLegality(n,a),t.gameboard.receiveAttack(a,n,r),A(y,x),N(y,x),!1}(e,t,Math.round((i-c/2)/c),Math.round((o-c/2)/c))},s=function(e,t,n,a){e.turn&&H&&K.add(n,"mousedown",(function c(i){if(o(e,t,n,i))return F(Y+1),void n.removeEventListener("mousedown",c);Ae(a,r,t),V({turn:t.playerNum,isHuman:t.isHuman}),n.removeEventListener("mousedown",c)}))},l=function(){s(i,u,t,a),s(u,i,e,n)},f=function(){i.turn?(w(i,u),Ae(a,r,u),V({turn:u.playerNum,isHuman:u.isHuman})):u.turn&&(w(i,u),Ae(n,r,i),V({turn:i.playerNum,isHuman:i.isHuman}))};function m(e){return p.apply(this,arguments)}function p(){return(p=Object(h.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){f()}),t),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.isWinner&&!u.isWinner){e.next=3;break}return E(!0),e.abrupt("return");case 3:if(!H||J.isHuman){e.next=7;break}return e.next=6,m(1e3);case 6:return e.abrupt("return");case 7:return l(),e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return S||function(){b.apply(this,arguments)}(),function(){clearTimeout(m)}}),[J,H,Y]),Object(m.jsxs)("div",{id:"Battle",children:[Object(m.jsxs)("div",{id:"upper-container",children:[Object(m.jsx)(p,{}),Object(m.jsx)("div",{id:"instructions-wrapper",children:S?Object(m.jsx)("span",{children:"Game ended"}):(i.isHuman||u.isHuman)&&H?Object(m.jsx)("span",{children:"Destroy the enemy's ships"}):!i.isHuman&&!u.isHuman||H?2!=t.value||H?Object(m.jsx)("span",{children:"Get some popcorn"}):Object(m.jsx)("span",{children:"Start the battle"}):Object(m.jsx)("span",{children:"Place the ships"})}),Object(m.jsxs)("div",{id:"upper-button-container",children:[Object(m.jsx)("button",{onClick:H?je:he,children:H?Object(m.jsx)("i",{className:"fas fa-redo-alt"}):Object(m.jsx)("i",{className:"fas fa-play"})}),Object(m.jsx)("button",{id:"outcome-visibility-button",onClick:me,children:D?Object(m.jsx)("i",{className:"fas fa-eye"}):Object(m.jsx)("i",{className:"fas fa-eye-slash"})})]})]}),(null!==i||null!==u)&&n<=500?Ee():null,Object(m.jsxs)("div",{id:"main-battle",children:[Pe(Q,r,"cv1",i),(null!==i||null!==u)&&n>500?Ee():null,Pe(U,r,"cv2",u)]}),0!==v.length&&D?0===oe?Object(m.jsx)(b,{p:i.turn,currentPlayer:i.turn?u.displayName:i.displayName,categoryNum:oe,coordinate:null,outcomesArr:v,setOutcomesArr:g}):Object(m.jsx)(b,{p:i.turn,currentPlayer:i.turn?u.displayName:i.displayName,categoryNum:oe,coordinate:de,outcomesArr:v,setOutcomesArr:g}):null]})}var L=n(16);function B(e){var t=e.setGamemode,n=e.gamemode,a=e.difficulty,r=e.setDifficulty,c=function(e){e.target.id.includes(2)||1==n.value?r(Object(L.a)(Object(L.a)({},a),{},{value:e.target.value,valB:e.target.value})):r(Object(L.a)(Object(L.a)({},a),{},{value:e.target.value,valA:e.target.value}))};return Object(m.jsxs)("div",{id:"Settings",children:[Object(m.jsx)("div",{className:"custom-select",children:Object(m.jsxs)("select",{name:"gamemodes",value:n.value,onChange:function(e){t({value:e.target.value})},children:[Object(m.jsx)("option",{value:"0",children:"PvP"}),Object(m.jsx)("option",{value:"1",children:"PvAI"}),Object(m.jsx)("option",{value:"2",children:"AIvAI"})]})}),2==n.value?Object(m.jsx)(H,{gamemode:n,difficulty:a,id:1,handleDifficultyChange:c}):null,0!=n.value?Object(m.jsx)(H,{gamemode:n,difficulty:a,id:2,handleDifficultyChange:c}):null]})}var H=function(e){var t=e.gamemode,n=e.difficulty,a=e.id,r=e.handleDifficultyChange;return Object(m.jsx)("div",{className:"custom-select",children:Object(m.jsxs)("select",{name:"diff",value:1==t||2==a?n.valB:n.valA,id:"ai-diff".concat(a),onChange:r,children:[Object(m.jsx)("option",{value:"1",children:1==t.value||1==a?"AI: Easy":"AI 2: Easy"}),Object(m.jsx)("option",{value:"2",children:1==t.value||1==a?"AI: Hard":"AI 2: Hard"})]})})};function I(){var e=Object(a.useState)({value:"0"}),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)({value:"1",valA:"1",valB:"1"}),i=Object(o.a)(c,2),u=i[0],l=i[1];return Object(m.jsx)(s.a,{children:Object(m.jsx)(M,{gamemode:n,setGamemode:r,difficulty:u,setDifficulty:l})})}function M(e){var t=e.gamemode,n=e.setGamemode,a=e.difficulty,r=e.setDifficulty;return Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{exact:!0,path:"/battleship/",children:Object(m.jsx)(R,{setGamemode:n,gamemode:t,difficulty:a,setDifficulty:r})}),Object(m.jsx)(u.a,{exact:!0,path:"/battleship/battle",children:Object(m.jsx)(E,{gamemode:t,difficulty:a})})]})}function R(e){var t=e.setGamemode,n=e.gamemode,r=e.difficulty,c=e.setDifficulty;return Object(a.useEffect)((function(){document.getElementById("prf").onclick=function(){window.location.href="https://github.com/law911012eqw"}})),Object(a.useEffect)((function(){!function(e,t){!function(e,t,n){k.apply(this,arguments)}(parseInt(e.value),parseInt(t.valA),parseInt(t.valB))}(n,r)}),[n,r]),Object(m.jsxs)("div",{id:"menu",children:[Object(m.jsxs)("div",{className:"title-wrapper",children:[Object(m.jsx)("h1",{id:"title",className:"title",children:"Battleship"}),Object(m.jsxs)("div",{className:"author-wrapper",children:[Object(m.jsx)("h2",{className:"divider",children:" | "}),Object(m.jsx)("h5",{className:"author",children:"Created by B.B Ant"}),Object(m.jsx)("div",{className:"frame",children:Object(m.jsx)("img",{id:"prf",className:"prof",src:"https://avatars.githubusercontent.com/u/73290979?s=400&u=2df2e8360dbecaf0265e22194b52647c95ea6e06&v=4",alt:"profile"})})]})]}),Object(m.jsx)("nav",{id:"nav-menu",children:Object(m.jsx)("ul",{children:Object(m.jsx)("div",{children:Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/battleship/battle",children:"Start Game"})})})})}),Object(m.jsx)(B,{setGamemode:t,gamemode:n,difficulty:r,setDifficulty:c})]})}var D=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(I,{})})};i.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(D,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.201ae993.chunk.js.map